<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>AI for Finance Teams ROI Calculator</title>
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Switzer:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
	<style>
		:root {
			color-scheme: light;
			--primary: #212bc4;
			--primary-strong: #222be0;
			--bg: #f7f8fb;
			--card: #ffffff;
			--border: rgba(0, 0, 0, 0.08);
			--muted: #5d6470;
			--text: #0b0c10;
		}
		html {
			height: 100%;
		}
		body {
			font-family: "Switzer", "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
			margin: 0;
			padding: 24px;
			min-height: 100%;
			background: var(--bg);
			color: var(--text);
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 12px;
			text-align: center;
		}
		.page-title {
			font-family: "Switzer", "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
			font-size: 28px;
			font-weight: 700;
			letter-spacing: -0.4px;
			margin: 0;
			color: var(--text);
		}
		.page-title span {
			color: var(--primary);
		}
		.layout {
			display: flex;
			flex-wrap: wrap;
			gap: 16px;
			align-items: flex-start;
			justify-content: center;
			width: 100%;
		}
		.guide {
			width: min(330px, 90vw);
			background: var(--card);
			border: 1px solid var(--border);
			box-shadow: 0 18px 50px rgba(16, 22, 38, 0.14);
			border-radius: 18px;
			padding: 16px;
			text-align: left;
		}
		.guide-block {
			background: #f9faff;
			border: 1px solid rgba(33, 43, 196, 0.1);
			border-radius: 14px;
			padding: 12px 14px;
			box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.75);
			margin-top: 10px;
		}
		.guide-subtitle {
			font-weight: 600;
			margin: 0 0 14px;
			font-size: 18px;
			color: var(--muted);
		}
		.guide-subtitle .accent {
			color: var(--primary);
			font-size: inherit;
			font-weight: inherit;
		}
		.key-list {
			list-style: none;
			padding: 0;
			margin: 0;
			display: grid;
			gap: 8px;
			font-size: 13px;
			color: var(--text);
			text-align: left;
		}
		.key-list li {
			line-height: 1.35;
		}
		.key-label {
			font-weight: 700;
		}
		.calc {
			width: min(520px, 94vw);
			border-radius: 18px;
			background: var(--card);
			border: 1px solid var(--border);
			box-shadow: 0 18px 50px rgba(16, 22, 38, 0.14);
			padding: 18px;
			color: var(--text);
			text-align: left;
		}
		.topbar {
			display: flex;
			gap: 10px;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 14px;
		}
		.pill {
			font-size: 12px;
			background: #f2f3f8;
			color: var(--muted);
			padding: 9px 12px;
			border: 1px solid var(--border);
			border-radius: 999px;
			display: inline-flex;
			gap: 8px;
			align-items: center;
			font-weight: 600;
		}
		.pill select {
			background: transparent;
			color: var(--text);
			border: none;
			outline: none;
			font-weight: 700;
		}
		.display {
			background: linear-gradient(180deg, #f0f2ff, #f9faff);
			border: 1px solid rgba(33, 43, 196, 0.12);
			border-radius: 16px;
			padding: 16px;
			min-height: 128px;
			margin-bottom: 14px;
			box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.65);
		}
		.input-window {
			background: #f9faff;
			border: 1px solid rgba(33, 43, 196, 0.1);
			border-radius: 14px;
			padding: 12px 14px;
			margin-bottom: 14px;
			box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.75);
		}
		.input-window .value {
			color: var(--primary-strong);
		}
		.display .label {
			font-size: 12px;
			color: var(--muted);
			font-weight: 600;
		}
		.display .value {
			color: var(--primary-strong);
			font-size: 24px;
			font-weight: 800;
			margin: 8px 0 12px;
		}
		.display .sub {
			font-size: 12px;
			color: var(--text);
			opacity: 0.92;
			line-height: 1.35;
			display: grid;
			gap: 6px;
		}
		.grid {
			display: grid;
			grid-template-columns: repeat(4, 1fr);
			gap: 10px;
			margin-top: 12px;
		}
		button {
			border: 1px solid var(--border);
			border-radius: 12px;
			padding: 12px 10px;
			background: #f7f8fb;
			color: var(--text);
			font-size: 13px;
			font-weight: 700;
			cursor: pointer;
			user-select: none;
			transition: transform 0.02s ease, background 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
		}
		button:hover {
			border-color: rgba(33, 43, 196, 0.35);
			box-shadow: 0 10px 22px rgba(16, 22, 38, 0.12);
		}
		button:active {
			transform: translateY(1px);
		}
		button:focus-visible {
			outline: 2px solid rgba(33, 43, 196, 0.5);
			outline-offset: 2px;
		}
		button.secondary {
			background: #eef0f5;
		}
		button.accent {
			background: var(--primary);
			border-color: var(--primary);
			color: #000;
			box-shadow: 0 12px 28px rgba(33, 43, 196, 0.28);
		}
		button.accent:hover {
			background: var(--primary-strong);
			border-color: var(--primary-strong);
			box-shadow: 0 14px 32px rgba(33, 43, 196, 0.32);
		}
		#calc .calc-label {
			background: linear-gradient(180deg, #f0f2ff, #f9faff);
			-webkit-background-clip: text;
			background-clip: text;
			-webkit-text-fill-color: transparent;
			color: transparent;
		}
		button.danger {
			background: #ffe1de;
			border-color: #ffc7c2;
			color: #7a1f1d;
		}
		button.wide {
			grid-column: span 2;
		}
		.mini {
			font-size: 11px;
			color: var(--text);
			opacity: 0.9;
			line-height: 1.25;
			margin-top: 12px;
			background: #f5f6fb;
			border: 1px solid var(--border);
			border-radius: 14px;
			padding: 10px;
		}
		.row {
			display: flex;
			justify-content: space-between;
			gap: 12px;
		}
		.muted {
			color: var(--muted);
		}
		.kbd {
			font-variant-numeric: tabular-nums;
			font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
		}
	</style>
</head>
<body>
	<h1 class="page-title">AI for Finance Teams <span>ROI Calculator</span></h1>
	<div class="layout">
		<aside class="guide" aria-label="Guide and Key">
			<div class="guide-block">
				<div class="guide-subtitle">Inputs <span class="accent">Explained</span></div>
				<ul class="key-list">
					<li><span class="key-label">Transactions per Month:</span> Total monthly transaction volume you expect the agent to touch.</li>
					<li><span class="key-label">Minutes per Transaction:</span> Average handling time on a clean transaction (no exception).</li>
					<li><span class="key-label">Exception Rate:</span> Percent of transactions that require exception handling.</li>
					<li><span class="key-label">Minutes per Exception:</span> Average handling time for an exception case.</li>
					<li><span class="key-label">Review Hours per Month:</span> Time leaders spend reviewing or approving work monthly.</li>
					<li><span class="key-label">Hourly Cost:</span> Fully loaded hourly cost for the people doing this work.</li>
					<li><span class="key-label">Touchless % / Reviewed %:</span> Share of work you expect the agent to automate; these should total ≤ 100%, with Manual filling the rest.</li>
					<li><span class="key-label">Touchless / Reviewed Time Saved %:</span> Estimated time reduction on the portions covered by the agent.</li>
					<li><span class="key-label">Expected vs Minimum Accuracy %:</span> Savings are shown only when Expected Accuracy meets or exceeds the Minimum threshold.</li>
					<li><span class="key-label">Ramp (Month 1 / 2 / 3+):</span> How quickly you assume recovered hours materialize over the first three months.</li>
				</ul>
			</div>
			<div class="guide-block">
				<div class="guide-subtitle">Outputs <span class="accent">Explained</span></div>
				<ul class="key-list">
					<li><span class="key-label">Hours Recovered (Steady):</span> Monthly hours saved after coverage, time-saved %, and the accuracy check.</li>
					<li><span class="key-label">Full-Time Equivalent Capacity:</span> Recovered hours divided by 160 hours per FTE per month.</li>
					<li><span class="key-label">Annual Cost Equivalent:</span> Recovered hours × hourly cost × 12 months.</li>
					<li><span class="key-label">Automation Rate:</span> Total of Touchless % + Reviewed %; Manual is the remainder.</li>
					<li><span class="key-label">Ramp by Month:</span> Month 1, Month 2, and Month 3+ savings based on your ramp assumptions.</li>
					<li><span class="key-label">Baseline vs Post Hours:</span> Shows starting hours per month and hours after automation is applied.</li>
				</ul>
			</div>
		</aside>
		<div class="calc" role="application" aria-label="ROI Calculator">
			<div class="topbar">
				<div class="pill">
					Workflow
					<select id="workflow">
						<option value="AP">Accounts Payable (AP)</option>
						<option value="AR">Accounts Receivable (AR)</option>
						<option value="RECON">Reconciliation</option>
					</select>
				</div>
				<div class="pill" style="visibility: hidden;">
					<span class="muted">Spacer</span>
				</div>
			</div>

			<div class="display" aria-live="polite">
				<div class="sub kbd" id="results">
					<div>Hours Recovered (Steady): —</div>
					<div>Full-Time Equivalent Capacity: —</div>
					<div>Annual Cost Equivalent: —</div>
					<div>Ramp (Month 1 / Month 2 / Month 3+): —</div>
				</div>
			</div>

			<div class="input-window" aria-live="polite">
				<div class="label" id="activeFieldLabel">Active Input: Transactions per Month</div>
				<div class="value kbd" id="activeFieldValue">3000</div>
			</div>

			<!-- calculator-like buttons: choose which input you're editing -->
			<div class="grid">
				<button class="secondary" data-field="transactions_per_month">Txn/Month</button>
				<button class="secondary" data-field="minutes_per_txn">Min/Txn</button>
				<button class="secondary" data-field="exception_rate_pct">Exc %</button>
				<button class="secondary" data-field="minutes_per_exception">Min/Exc</button>

				<button class="secondary" data-field="review_hours_per_month">Review Hrs</button>
				<button class="secondary" data-field="hourly_cost">$/Hr</button>
				<button class="secondary" data-field="touchless_pct">Touchless %</button>
				<button class="secondary" data-field="reviewed_pct">Reviewed %</button>

				<button class="secondary" data-field="touchless_reduction_pct">TL Save %</button>
				<button class="secondary" data-field="reviewed_reduction_pct">RV Save %</button>
				<button class="secondary" data-field="expected_accuracy_pct">Agent Acc %</button>
				<button class="secondary" data-field="min_accuracy_pct">Min Acc %</button>

				<button class="danger wide" id="clear">AC</button>
				<button class="accent wide" id="calc"><span class="calc-label">= Calculate</span></button>

				<!-- numeric keypad -->
				<button data-digit="7">7</button>
				<button data-digit="8">8</button>
				<button data-digit="9">9</button>
				<button class="secondary" id="back">⌫</button>

				<button data-digit="4">4</button>
				<button data-digit="5">5</button>
				<button data-digit="6">6</button>
				<button class="secondary" id="dot">.</button>

				<button data-digit="1">1</button>
				<button data-digit="2">2</button>
				<button data-digit="3">3</button>
				<button class="secondary" disabled aria-disabled="true" aria-hidden="true" tabindex="-1" style="visibility: hidden;">&nbsp;</button>

				<button class="wide" data-digit="0">0</button>
			<button class="secondary wide" id="setDefaults">Set Default Value</button>
			</div>

			<div class="mini">
				<div class="row">
					<span class="muted">Notes:</span>
					<span class="kbd" id="noteLine">Conservative Assumptions. Capacity Recovered ≠ Headcount Reduction.</span>
				</div>
			</div>
		</div>
	</div>

	<script>
		// --- Defaults (conservative, editable) ---
		const DEFAULTS = {
			workflow: "AP",
			// Inputs
			transactions_per_month: 3000,
			minutes_per_txn: 6.0,
			exception_rate_pct: 25.0,
			minutes_per_exception: 18.0,
			review_hours_per_month: 30.0,
			hourly_cost: 65.0,

			// Automation coverage (must sum to 100)
			touchless_pct: 60.0,
			reviewed_pct: 30.0,
			manual_pct: 10.0,

			// Time reduction assumptions
			touchless_reduction_pct: 95.0,
			reviewed_reduction_pct: 60.0,
			manual_reduction_pct: 0.0,

			// Accuracy gate + ramp
			expected_accuracy_pct: 97.0,
			min_accuracy_pct: 97.0,
			ramp_m1_pct: 25.0,
			ramp_m2_pct: 60.0,
			ramp_m3_pct: 100.0,

			// Constants
			hours_per_fte_month: 160
		};

		// --- State ---
		let state = structuredClone(DEFAULTS);

		const fieldLabels = {
			transactions_per_month: "Transactions per Month",
			minutes_per_txn: "Minutes per Transaction (Happy Path)",
			exception_rate_pct: "Exception Rate (%)",
			minutes_per_exception: "Minutes per Exception",
			review_hours_per_month: "Review Hours per Month",
			hourly_cost: "Fully Loaded $/Hour",
			touchless_pct: "Touchless (%)",
			reviewed_pct: "Reviewed (%)",
			manual_pct: "Manual (%)",
			touchless_reduction_pct: "Touchless Time Saved (%)",
			reviewed_reduction_pct: "Reviewed Time Saved (%)",
			expected_accuracy_pct: "Expected Agent Accuracy (%)",
			min_accuracy_pct: "Minimum Acceptable Accuracy (%)"
		};

		let activeField = "transactions_per_month";
		let entryBuffer = String(state[activeField]);

		// --- DOM ---
		const workflowEl = document.getElementById("workflow");
		const activeFieldLabelEl = document.getElementById("activeFieldLabel");
		const activeFieldValueEl = document.getElementById("activeFieldValue");
		const resultsEl = document.getElementById("results");
		const noteLineEl = document.getElementById("noteLine");

		function setActiveField(field) {
			activeField = field;
			entryBuffer = String(state[field]);
			activeFieldLabelEl.textContent = "Active Input: " + (fieldLabels[field] || field);
			activeFieldValueEl.textContent = entryBuffer;
		}

		function commitEntry() {
			const val = Number(entryBuffer);
			if (!Number.isFinite(val)) return;
			state[activeField] = val;
		}

		function fmtNum(n, decimals = 0) {
			return new Intl.NumberFormat(undefined, { maximumFractionDigits: decimals, minimumFractionDigits: decimals }).format(n);
		}
		function fmtMoney(n) {
			return new Intl.NumberFormat(undefined, { style: "currency", currency: "USD", maximumFractionDigits: 0 }).format(n);
		}

		function normalizeCoverage() {
			// Keep manual_pct derived to force sum=100 (more robust UX)
			const tl = Number(state.touchless_pct) || 0;
			const rv = Number(state.reviewed_pct) || 0;
			let manual = 100 - tl - rv;
			if (manual < 0) manual = 0;
			state.manual_pct = manual;
		}

	function validate() {
		const errs = [];
		const labelFor = field => fieldLabels[field] || field.replace(/_/g, " ");
		const pctFields = [
			"exception_rate_pct",
			"touchless_pct",
			"reviewed_pct",
			"manual_pct",
				"touchless_reduction_pct",
				"reviewed_reduction_pct",
				"expected_accuracy_pct",
				"min_accuracy_pct",
				"ramp_m1_pct",
				"ramp_m2_pct",
				"ramp_m3_pct"
		];
		pctFields.forEach(f => {
			const v = Number(state[f]);
			if (Number.isFinite(v) && (v < 0 || v > 100)) errs.push(`${labelFor(f)} Must Be 0–100`);
		});
		if (state.transactions_per_month < 0) errs.push(`${labelFor("transactions_per_month")} Must Be ≥ 0`);
		if (state.minutes_per_txn < 0) errs.push(`${labelFor("minutes_per_txn")} Must Be ≥ 0`);
		if (state.minutes_per_exception < 0) errs.push(`${labelFor("minutes_per_exception")} Must Be ≥ 0`);
		if (state.review_hours_per_month < 0) errs.push(`${labelFor("review_hours_per_month")} Must Be ≥ 0`);
		if (state.hourly_cost < 0) errs.push(`${labelFor("hourly_cost")} Must Be ≥ 0`);

			// Coverage should not exceed 100 between tl + rv (manual derived)
		if (state.touchless_pct + state.reviewed_pct > 100) errs.push("Touchless % + Reviewed % Must Be ≤ 100");
		return errs;
	}

		function calculate() {
			normalizeCoverage();
			const errs = validate();
			if (errs.length) {
				resultsEl.innerHTML = errs.map(e => `<div>⚠️ ${e}</div>`).join("");
				noteLineEl.textContent = "Fix Inputs and Recalculate.";
				return;
			}

			// Baseline hours:
			// baseline = (txn * mins_happy + txn * exc_rate * mins_exc) / 60 + review_hours
			const txn = state.transactions_per_month;
			const minsHappy = state.minutes_per_txn;
			const excRate = state.exception_rate_pct / 100;
			const minsExc = state.minutes_per_exception;
			const reviewHrs = state.review_hours_per_month;

			const baselineHours = ((txn * minsHappy) + (txn * excRate * minsExc)) / 60 + reviewHrs;

			// Weighted time saved across coverage buckets:
			const tl = state.touchless_pct / 100;
			const rv = state.reviewed_pct / 100;
			const man = state.manual_pct / 100;

			const tlSave = state.touchless_reduction_pct / 100;
			const rvSave = state.reviewed_reduction_pct / 100;
			const manSave = state.manual_reduction_pct / 100;

			// Savings only apply to the "processable" portion of baseline work.
			// Conservative: assume review_hours are part of the same baseline pool and proportionally reducible.
			const weightedSave = tl * tlSave + rv * rvSave + man * manSave;
			const steadyRecoveredHours = baselineHours * weightedSave;
			const steadyPostHours = baselineHours - steadyRecoveredHours;

			// Accuracy gate
			const gateApplies = state.expected_accuracy_pct < state.min_accuracy_pct;
			const recoveredHoursGated = gateApplies ? 0 : steadyRecoveredHours;

			// Ramp
			const m1 = recoveredHoursGated * (state.ramp_m1_pct / 100);
			const m2 = recoveredHoursGated * (state.ramp_m2_pct / 100);
			const m3 = recoveredHoursGated * (state.ramp_m3_pct / 100);

			// Outputs
			const fte = recoveredHoursGated / state.hours_per_fte_month;
			const annual = recoveredHoursGated * state.hourly_cost * 12;

			noteLineEl.textContent = gateApplies
				? `Expected Accuracy ${state.expected_accuracy_pct}% Is Below Minimum ${state.min_accuracy_pct}%; Savings Are Set to $0.`
				: "Capacity Recovered ≠ Headcount Reduction. Assumptions Are Conservative.";

			resultsEl.innerHTML = `
				<div>Hours Recovered (Steady): <b>${fmtNum(recoveredHoursGated, 0)}</b> per Month</div>
				<div>Full-Time Equivalent Capacity: <b>${fmtNum(fte, 2)}</b></div>
				<div>Annual Cost Equivalent: <b>${fmtMoney(annual)}</b></div>
				<div>Automation Rate: <b>${fmtNum(state.touchless_pct + state.reviewed_pct, 0)}%</b> (Manual ${fmtNum(state.manual_pct, 0)}%)</div>
				<div>Ramp (Month 1 / Month 2 / Month 3+): <b>${fmtNum(m1, 0)}</b> / <b>${fmtNum(m2, 0)}</b> / <b>${fmtNum(m3, 0)}</b> Hours</div>
				<div class="muted">Baseline Hours per Month: ${fmtNum(baselineHours, 0)} · Post Hours per Month: ${fmtNum(baselineHours - recoveredHoursGated, 0)}</div>
			`;
		}

		// --- Wiring ---
		workflowEl.value = state.workflow;
		workflowEl.addEventListener("change", () => {
			state.workflow = workflowEl.value;
		});

		document.querySelectorAll("button[data-field]").forEach(btn => {
			btn.addEventListener("click", () => {
				commitEntry();
				setActiveField(btn.dataset.field);
			});
		});

		document.querySelectorAll("button[data-digit]").forEach(btn => {
			btn.addEventListener("click", () => {
				const d = btn.dataset.digit;
				// Replace if buffer is same as current state value and user starts typing
				if (entryBuffer === String(state[activeField])) entryBuffer = "";
				entryBuffer += d;
				activeFieldValueEl.textContent = entryBuffer;
			});
		});

		document.getElementById("dot").addEventListener("click", () => {
			if (!entryBuffer.includes(".")) {
				if (entryBuffer === String(state[activeField])) entryBuffer = "";
				entryBuffer = entryBuffer.length ? `${entryBuffer}.` : "0.";
				activeFieldValueEl.textContent = entryBuffer;
			}
		});

		document.getElementById("back").addEventListener("click", () => {
			entryBuffer = entryBuffer.slice(0, -1);
			if (entryBuffer === "" || entryBuffer === "-") entryBuffer = "0";
			activeFieldValueEl.textContent = entryBuffer;
		});

		document.getElementById("clear").addEventListener("click", () => {
			state = structuredClone(DEFAULTS);
			workflowEl.value = state.workflow;
			setActiveField("transactions_per_month");
			resultsEl.innerHTML = `
				<div>Hours Recovered (Steady): —</div>
				<div>Full-Time Equivalent Capacity: —</div>
				<div>Annual Cost Equivalent: —</div>
				<div>Ramp (Month 1 / Month 2 / Month 3+): —</div>
			`;
			noteLineEl.textContent = "Conservative Assumptions. Capacity Recovered ≠ Headcount Reduction.";
		});

		document.getElementById("setDefaults").addEventListener("click", () => {
			if (DEFAULTS[activeField] !== undefined) {
				state[activeField] = DEFAULTS[activeField];
				entryBuffer = String(DEFAULTS[activeField]);
				activeFieldValueEl.textContent = entryBuffer;
			}
			calculate();
		});

		document.getElementById("calc").addEventListener("click", () => {
			commitEntry();
			calculate();
		});

		// init
		setActiveField(activeField);
		calculate();
	</script>
</body>
</html>
